(()=>{"use strict";var e={20:(e,t,a)=>{var r=a(609),n=Symbol.for("react.element"),o=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,a){var r,i={},c=null,d=null;for(r in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:n,type:e,key:c,ref:d,props:i,_owner:l.current}}},609:e=>{e.exports=window.React},848:(e,t,a)=>{e.exports=a(20)}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,a),o.exports}var r=a(609);const n=window.wp.element,o=window.wp.components,l=function({setActiveView:e}){return(0,r.createElement)("div",{className:"atm-hub"},(0,r.createElement)("h2",null,"How can I help you today :)"),(0,r.createElement)("p",{className:"atm-hub-subtitle"},"Generate articles, images, podcasts and many more soon"),(0,r.createElement)("div",{className:"atm-hub-actions"},(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>e("articles")},"Generate Articles"),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>e("images")},"Generate Images"),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>e("podcast")},"Generate Podcast"),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>e("graphs")},"Generate Graphs"),(0,r.createElement)(o.Button,{isPrimary:!0,disabled:!0},"Generate Videos"),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>e("speech_to_text")},"Speech to Text")),(0,r.createElement)("p",{className:"atm-hub-footer"},"Your Day to Day AI helper, Content AI Studio."))},s=window.wp.data,i=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),c=function(){const[e,t]=(0,n.useState)(!1),[a,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[p,g]=(0,n.useState)("default_seo"),[h,w]=(0,n.useState)(""),[b,v]=(0,n.useState)(""),[E,f]=(0,n.useState)(""),[_,y]=(0,n.useState)(!1),{savePost:S}=(0,s.useDispatch)("core/editor"),k=(0,s.useSelect)(e=>e("core/editor").isSavingPost()),C=[{label:"Use Default Model",value:""},...Object.entries(atm_studio_data.article_models).map(([e,t])=>({label:t,value:e}))],x=Object.entries(atm_studio_data.writing_styles).map(([e,{label:t}])=>({label:t,value:e}));return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(o.TextControl,{label:"Keyword",value:c,onChange:d,placeholder:"e.g., AI in digital marketing",disabled:e||k}),(0,r.createElement)(o.TextControl,{label:"or Article Title",value:u,onChange:m,placeholder:"e.g., 5 Ways AI is Revolutionizing Marketing",disabled:e||k})),(0,r.createElement)("div",{className:"atm-grid-3"},(0,r.createElement)(o.SelectControl,{label:"Article Model",value:h,options:C,onChange:w,disabled:e||k}),(0,r.createElement)(o.SelectControl,{label:"Writing Style",value:p,options:x,onChange:g,disabled:e||k}),(0,r.createElement)(o.SelectControl,{label:"Article Length",value:b,options:[{label:"Default",value:""},{label:"Short (~500 words)",value:"500"},{label:"Standard (~800 words)",value:"800"},{label:"Medium (~1200 words)",value:"1200"},{label:"Long (~2000 words)",value:"2000"}],onChange:v,disabled:e||k})),(0,r.createElement)(o.TextareaControl,{label:"Custom Prompt (Optional)",value:E,onChange:f,placeholder:"Leave empty to use the selected Writing Style. If you write a prompt here, it will be used instead.",rows:"6",disabled:e||k}),(0,r.createElement)(o.CheckboxControl,{label:"Also generate a featured image",checked:_,onChange:y,disabled:e||k}),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:async()=>{t(!0);const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");if(!u&&!c)return alert("Please provide a keyword or an article title."),void t(!1);try{let a=u;if(!a&&c){l("Generating compelling title...");const e=await i("generate_article_title",{keyword:c,model:h});if(!e.success)throw new Error(e.data);a=e.data.article_title}l("Writing article content...");const r=await i("generate_article_content",{post_id:e,article_title:a,model:h,writing_style:p,custom_prompt:E,word_count:b});if(!r.success)throw new Error(r.data);if(((e,t)=>{const a=document.body.classList.contains("block-editor-page"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(a,r.data.article_content),l("✅ Article content inserted!"),_){l("Saving post..."),await S(),l("Generating featured image...");const t=await i("generate_featured_image",{post_id:e,prompt:""});if(t.success)return l("✅ All done! Reloading to show new image..."),void setTimeout(()=>window.location.reload(),1500);alert("Article was generated and saved, but the image failed: "+t.data)}t(!1),setTimeout(()=>l(""),3e3)}catch(e){const a=e.message||"An unknown error occurred.";l(`Error: ${a}`),t(!1)}},disabled:e||k||!c&&!u},e||k?(0,r.createElement)(o.Spinner,null):"Generate Creative Article"),a&&(0,r.createElement)("p",{className:"atm-status-message"},a))},d=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),u=function(){const[e,t]=(0,n.useState)(!1),[a,l]=(0,n.useState)(""),[i,c]=(0,n.useState)(""),[u,m]=(0,n.useState)("newsapi"),[p,g]=(0,n.useState)(!1),[h,w]=(0,n.useState)(!1),{savePost:b}=(0,s.useDispatch)("core/editor"),v=(0,s.useSelect)(e=>e("core/editor").isSavingPost());return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(o.TextControl,{label:"News Topic",value:i,onChange:c,placeholder:"e.g., recent AI developments",disabled:e||v}),(0,r.createElement)(o.SelectControl,{label:"News Source",value:u,options:[{label:"NewsAPI.org",value:"newsapi"},{label:"GNews.io",value:"gnews"},{label:"The Guardian",value:"guardian"}],onChange:m,disabled:e||v}),(0,r.createElement)(o.CheckboxControl,{label:"Force fresh search (bypasses cache)",checked:p,onChange:g,disabled:e||v}),(0,r.createElement)(o.CheckboxControl,{label:"Also generate a featured image",checked:h,onChange:w,disabled:e||v}),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:async()=>{if(!i)return void alert("Please enter a topic for the news article.");t(!0),l("Searching for latest news...");const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const a=await d("generate_news_article",{topic:i,news_source:u,force_fresh:p});if(!a.success)throw new Error(a.data);if(l("Writing article..."),((e,t)=>{const a=document.body.classList.contains("block-editor-page"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(a.data.article_title,a.data.article_content),l("✅ News article inserted!"),h){l("Saving post..."),await b(),l("Generating featured image...");const t=await d("generate_featured_image",{post_id:e,prompt:""});if(t.success)return l("✅ All done! Reloading to show image..."),void setTimeout(()=>window.location.reload(),1500);alert("Article was generated and saved, but the image failed: "+t.data)}t(!1),setTimeout(()=>l(""),3e3)}catch(e){l(`Error: ${e.message}`),t(!1)}},disabled:e||v||!i},e||v?(0,r.createElement)(o.Spinner,null):"Generate News Article"),a&&(0,r.createElement)("p",{className:"atm-status-message"},a))},m=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),p=function(){const[e,t]=(0,n.useState)(!1),[a,l]=(0,n.useState)(""),[s,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),[u,p]=(0,n.useState)(!0),[g,h]=(0,n.useState)([]),w=async(e="",a=!1)=>{t(!0),l(e?"Searching feeds...":"Fetching latest..."),h([]);const r=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const t=await m("fetch_rss_articles",{post_id:r,keyword:e,use_scraping:a});if(!t.success)throw new Error(t.data);h(t.data),l(t.data.length>0?`Found ${t.data.length} articles.`:"No articles found.")}catch(e){l(`Error: ${e.message}`)}finally{t(!1)}};return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(o.TextControl,{label:"Search by Keyword (Optional)",value:s,onChange:i,placeholder:"e.g., Trump, AI, Healthcare",disabled:e}),(0,r.createElement)(o.CheckboxControl,{label:"Deep Content Search",help:"Scrapes full article content for more accurate keyword matching (slower but more precise).",checked:c,onChange:d,disabled:e}),(0,r.createElement)(o.CheckboxControl,{label:"Use Full Article Content for Generation",help:"Scrapes the complete article for better AI rewriting (recommended).",checked:u,onChange:p,disabled:e}),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(o.Button,{isSecondary:!0,onClick:()=>w(s,c),disabled:e||!s},e?(0,r.createElement)(o.Spinner,null):"Search Feeds"),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>w(),disabled:e},e?(0,r.createElement)(o.Spinner,null):"Fetch Latest Articles")),a&&(0,r.createElement)("p",{className:"atm-status-message"},a),g.length>0&&(0,r.createElement)("div",{className:"atm-rss-results-list"},g.map((a,n)=>(0,r.createElement)("div",{key:a.guid,className:"atm-rss-item"},(0,r.createElement)("strong",{className:"atm-rss-item-title"},a.title),(0,r.createElement)("small",{className:"atm-rss-item-meta"},a.source," | ",a.date),(0,r.createElement)("p",{className:"atm-rss-item-desc"},a.description.substring(0,120),"..."),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>(async(e,a)=>{l(`Generating from "${e.title}"...`),t(!0);const r=[...g];r[a].isGenerating=!0,h(r);const n=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const t=await m("generate_article_from_rss",{post_id:n,article_url:e.link,article_guid:e.guid,rss_content:e.content,use_full_content:u});if(!t.success)throw new Error(t.data);((e,t)=>{const a=document.body.classList.contains("block-editor-page"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(t.data.article_title,t.data.article_content),l(`✅ Article generated from "${e.title}"!`),h(g.filter((e,t)=>t!==a))}catch(e){l(`Error: ${e.message}`)}finally{t(!1);const e=[...g];e[a].isGenerating=!1,h(e)}})(a,n),disabled:e||a.isGenerating},a.isGenerating?(0,r.createElement)(o.Spinner,null):"Generate Article")))))},g=function({setActiveView:e}){const[t,a]=(0,n.useState)("creative");return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub")},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Generate Article")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(o.SelectControl,{label:"Article Type",value:t,options:[{label:"Creative Article",value:"creative"},{label:"Latest News Article",value:"news"},{label:"Article from RSS Feed",value:"rss_feed"}],onChange:e=>a(e)}),(0,r.createElement)("hr",{className:"atm-form-divider"}),(()=>{switch(t){case"news":return(0,r.createElement)(u,null);case"rss_feed":return(0,r.createElement)(p,null);default:return(0,r.createElement)(c,null)}})()))},h=window.wp.primitives;var w=a(848);const b=(0,w.jsx)(h.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,w.jsx)(h.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})}),v=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[p,g]=(0,n.useState)("Use Default"),[h,w]=(0,n.useState)(""),[v,E]=(0,n.useState)("Use Default"),[f,_]=(0,n.useState)(""),[y,S]=(0,n.useState)(""),{editPost:k}=((0,n.useRef)(null),(0,n.useRef)(null),(0,n.useRef)(null),(0,s.useDispatch)("core/editor")),{image_provider:C}=atm_studio_data,x=f||C,N=({label:e,text:t,options:a,onChange:l,disabled:s,helpText:i})=>{const c=(0,n.useRef)(null);return(0,r.createElement)("div",{className:"atm-dropdown-field",ref:c},(0,r.createElement)("label",{className:"atm-dropdown-label"},e),(0,r.createElement)(o.DropdownMenu,{className:"atm-custom-dropdown",icon:b,text:t,controls:a.map(e=>({title:e.label,onClick:()=>{l(e)}})),disabled:s,popoverProps:{className:"atm-popover",style:{"--atm-dropdown-width":c.current?.offsetWidth?c.current.offsetWidth+"px":"auto"}}}),i&&(0,r.createElement)("p",{className:"atm-dropdown-help"},i))},A=[{label:`Use Default (${C})`,value:""},{label:"OpenAI (DALL-E 3)",value:"openai"},{label:"Google (Imagen 4)",value:"google"}];return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:t},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Generate Featured Image")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(N,{label:"Image Provider",text:y||`Use Default (${C})`,options:A,onChange:e=>{_(e.value),S(e.label)},disabled:t}),(0,r.createElement)(o.TextareaControl,{label:"Image Prompt",help:"A descriptive prompt is required for image generation.",value:c,onChange:d,placeholder:"A cinematic, photorealistic image of...",rows:"5",disabled:t}),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(N,{label:"Image Size (Override)",text:p,options:[{label:"Use Default",value:""},{label:"16:9 Landscape",value:"1792x1024"},{label:"1:1 Square",value:"1024x1024"},{label:"9:16 Portrait",value:"1024x1792"}],onChange:e=>{m(e.value),g(e.label)},disabled:t}),(0,r.createElement)(N,{label:"Quality (Override)",text:v,options:[{label:"Use Default",value:""},{label:"Standard",value:"standard"},{label:"HD",value:"hd"}],onChange:e=>{w(e.value),E(e.label)},disabled:t,helpText:"openai"!==x?"Note: Quality setting is only for OpenAI/DALL-E 3.":""})),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:async()=>{if(!c.trim())return void alert("Please enter a prompt for the image.");a(!0),i("Enhancing prompt & generating image...");const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const a=await(t={post_id:e,prompt:c,size:u,quality:h,provider:x},jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:"generate_featured_image",nonce:atm_studio_data.nonce,...t}}));if(!a.success)throw new Error(a.data);{i("âœ… Image generated and set!");const{attachment_id:e,html:t}=a.data;document.body.classList.contains("block-editor-page")?k({featured_media:e}):jQuery("#postimagediv .inside").html(t)}}catch(e){const t=e.message||"An unknown error occurred.";i(`Error: ${t}`)}finally{a(!1),setTimeout(()=>i(""),5e3)}var t},disabled:t},t?(0,r.createElement)(o.Spinner,null):"Generate & Set Featured Image"),l&&(0,r.createElement)("p",{className:"atm-status-message"},l)))},E=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}});function f({podcastUrl:e,initialScript:t,onRegenerate:a,postId:l}){const[s,i]=(0,n.useState)(!1);return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)("h4",null,"Your Podcast is Ready"),(0,r.createElement)("audio",{controls:!0,src:e,style:{width:"100%",marginBottom:"1rem"}},"Your browser does not support the audio element."),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(o.Button,{isSecondary:!0,onClick:()=>{const e=wp.media({title:"Select Podcast Cover Image",button:{text:"Use This Image"},multiple:!1,library:{type:"image"}});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();E("upload_podcast_image",{post_id:l,image_url:t.url}).done(()=>window.location.reload())}),e.open()}},"Change Cover Image"),(0,r.createElement)(o.Button,{isDestructive:!0,onClick:()=>a(t),disabled:s},s?(0,r.createElement)(o.Spinner,null):"Regenerate Audio")))}function _({handleGenerateScript:e,handleGenerateAudio:t,statusMessage:a,isLoading:l}){const[s,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)("English"),[p,g]=(0,n.useState)(atm_studio_data.audio_provider||"openai"),h=Object.entries(atm_studio_data.tts_voices).map(([e,t])=>({label:t,value:e})),w=Object.entries(atm_studio_data.elevenlabs_voices).map(([e,t])=>({label:t,value:e})),b="elevenlabs"===p?w:h;return(0,n.useEffect)(()=>{b.length>0&&!c&&d(b[0].value)},[p,b.length]),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(o.SelectControl,{label:"Script Language",value:u,onChange:m,options:[{label:"English",value:"English"},{label:"Spanish",value:"Spanish"},{label:"French",value:"French"},{label:"German",value:"German"}],disabled:l}),(0,r.createElement)(o.Button,{isSecondary:!0,onClick:()=>e(u,i),disabled:l},l&&a.includes("script")?(0,r.createElement)(o.Spinner,null):"1. Generate Script from Post Content"),(0,r.createElement)(o.TextareaControl,{label:"Podcast Script",help:"The generated script will appear here. You can edit it before generating the audio.",value:s,onChange:i,rows:"15",disabled:l}),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(o.SelectControl,{label:"Audio Provider",value:p,onChange:g,options:[{label:"OpenAI TTS",value:"openai"},{label:"ElevenLabs",value:"elevenlabs"}],disabled:l||0===w.length,help:0===w.length?"Enter ElevenLabs API key in settings to enable.":""}),(0,r.createElement)(o.SelectControl,{label:"AI Voice",value:c,onChange:d,options:b,disabled:l||!b.length,help:b.length?"":"No voices available for this provider."})),(0,r.createElement)(o.Button,{isPrimary:!0,onClick:()=>t(s,c,p),disabled:l||!s.trim()||!c},l&&a.includes("audio")?(0,r.createElement)(o.Spinner,null):"2. Generate MP3 Audio"))}const y=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[o,l]=(0,n.useState)(""),i=(0,s.useSelect)(e=>e("core/editor").getCurrentPostId(),[]),{existing_podcast_url:c,existing_podcast_script:d}=atm_studio_data,u=async(e,t,r)=>{if(e.trim()){a(!0),l("Generating MP3 audio... this may take a minute.");try{const a=await E("generate_podcast",{post_id:i,script:e,voice:t,provider:r});if(!a.success)throw new Error(a.data);l("✅ Success! The page will now reload to show the audio player."),setTimeout(()=>window.location.reload(),2e3)}catch(e){l(`Error generating audio: ${e.message}`),a(!1)}}else alert("Script cannot be empty.")};return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:t},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Generate Podcast")),c?(0,r.createElement)(f,{podcastUrl:c,initialScript:d,onRegenerate:u,postId:i}):(0,r.createElement)(_,{handleGenerateScript:async(e,t)=>{const r=wp.data.select("core/editor").getEditedPostContent();if(r.trim()){a(!0),l("Generating podcast script...");try{const a=await E("generate_podcast_script",{content:r,post_id:i,language:e});if(!a.success)throw new Error(a.data);t(a.data.script),l("✅ Script generated successfully. You can now edit it below.")}catch(e){l(`Error generating script: ${e.message}`)}finally{a(!1)}}else alert("Please write some content in the editor before generating a script.")},handleGenerateAudio:u,statusMessage:o,isLoading:t}),o&&(0,r.createElement)("p",{className:"atm-status-message"},o))},S=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[l,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)("Click the button to start recording."),u=(0,n.useRef)(null),m=(0,n.useRef)([]),{insertBlocks:p}=(0,s.useDispatch)("core/block-editor");(0,n.useEffect)(()=>{!t&&m.current.length>0&&g()},[t]);const g=async()=>{i(!0);let e="";const t=m.current.length;for(let a=0;a<t;a++){d(`Transcribing chunk ${a+1} of ${t}...`);const r=m.current[a],n=new FormData;n.append("action","transcribe_audio"),n.append("nonce",atm_studio_data.nonce),n.append("audio_chunk",r,"audio.webm");try{const t=await jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:n,processData:!1,contentType:!1});if(!t.success)throw new Error(t.data);e+=t.data.transcript+" "}catch(e){return d(`Error during transcription: ${e.message||"Unknown error"}`),void i(!1)}}const a=wp.blocks.createBlock("core/paragraph",{content:e.trim()});p(a),d("✅ Transcription complete and inserted into the editor!"),i(!1),m.current=[],setTimeout(()=>d("Click the button to start a new recording."),3e3)},h=t||l;return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:h},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Speech to Text")),(0,r.createElement)("div",{className:"atm-speech-to-text-container"},(0,r.createElement)(o.Button,{isPrimary:!0,className:"atm-record-button "+(t?"is-recording":""),onClick:t?()=>{u.current&&(u.current.stop(),u.current.stream.getTracks().forEach(e=>e.stop()))}:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});u.current=new MediaRecorder(e),m.current=[],u.current.ondataavailable=e=>{e.data.size>0&&m.current.push(e.data)},u.current.onstop=()=>{a(!1)},u.current.start(3e4),a(!0),d("Recording... Click to stop.")}catch(e){d("Error: Could not access microphone. Please grant permission."),console.error("Microphone access error:",e)}},disabled:l},l?(0,r.createElement)(o.Spinner,null):t?"Stop Recording":"Start Recording"),(0,r.createElement)("p",{className:"atm-status-message"},c)))},k=function(){const[e,t]=(0,n.useState)(sessionStorage.getItem("atm-active-view")||"hub");return(0,n.useEffect)(()=>{sessionStorage.setItem("atm-active-view",e)},[e]),(0,r.createElement)("div",{className:"atm-studio-container"},(()=>{switch(e){case"articles":return(0,r.createElement)(g,{setActiveView:t});case"images":return(0,r.createElement)(v,{setActiveView:t});case"podcast":return(0,r.createElement)(y,{setActiveView:t});case"speech_to_text":return(0,r.createElement)(S,{setActiveView:t});default:return(0,r.createElement)(l,{setActiveView:t})}})())};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("atm-studio-root");e&&(0,n.render)((0,r.createElement)(k,null),e)})})();