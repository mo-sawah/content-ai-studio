(()=>{"use strict";var e={20:(e,t,a)=>{var r=a(609),n=Symbol.for("react.element"),l=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,a){var r,s={},c=null,d=null;for(r in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,r)&&!i.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:n,type:e,key:c,ref:d,props:s,_owner:o.current}}},609:e=>{e.exports=window.React},848:(e,t,a)=>{e.exports=a(20)}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var l=t[r]={exports:{}};return e[r](l,l.exports,a),l.exports}var r=a(609);const n=window.wp.element,l=window.wp.components,o=window.wp.primitives;var i=a(848);const s=(0,i.jsx)(o.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)(o.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})}),c=window.wp.data,d=function(){const e=`${atm_studio_data.plugin_url}assets/images/spin.svg`;return(0,n.createElement)("img",{src:e,className:"atm-custom-spinner",alt:"Loading...",style:{width:"20px",height:"20px"}})},m=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),u=function(){const[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(""),[i,u]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[g,v]=(0,n.useState)("default_seo"),[b,w]=(0,n.useState)(""),[E,f]=(0,n.useState)(""),[y,_]=(0,n.useState)("Use Default Model"),[k,S]=(0,n.useState)(""),[C,x]=(0,n.useState)("Default"),[N,T]=(0,n.useState)(""),[A,P]=(0,n.useState)(!1),[j,L]=(0,n.useState)(""),{savePost:B}=(0,c.useDispatch)("core/editor"),M=(0,c.useSelect)(e=>e("core/editor").isSavingPost()),I=({label:e,text:t,options:a,onChange:o,disabled:i,helpText:c})=>{const d=(0,n.useRef)(null);return(0,r.createElement)("div",{className:"atm-dropdown-field",ref:d},(0,r.createElement)("label",{className:"atm-dropdown-label"},e),(0,r.createElement)(l.DropdownMenu,{className:"atm-custom-dropdown",icon:s,text:t,controls:a.map(e=>({title:e.label,onClick:()=>{o(e)}})),disabled:i,popoverProps:{className:"atm-popover",style:{"--atm-dropdown-width":d.current?.offsetWidth?d.current.offsetWidth+"px":"auto"}}}),c&&(0,r.createElement)("p",{className:"atm-dropdown-help"},c))},G=[{label:"Use Default Model",value:""},...Object.entries(atm_studio_data.article_models).map(([e,t])=>({label:t,value:e}))],D=Object.entries(atm_studio_data.writing_styles).map(([e,{label:t}])=>({label:t,value:e}));if(!b&&D.length>0){const e=D.find(e=>e.value===g);e&&w(e.label)}return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(l.TextControl,{label:"Keyword",value:i,onChange:u,placeholder:"e.g., AI in digital marketing",disabled:e||M}),(0,r.createElement)(l.TextControl,{label:"or Article Title",value:p,onChange:h,placeholder:"e.g., 5 Ways AI is Revolutionizing Marketing",disabled:e||M})),(0,r.createElement)("div",{className:"atm-grid-3"},(0,r.createElement)(I,{label:"Article Model",text:y,options:G,onChange:e=>{f(e.value),_(e.label)},disabled:e||M}),(0,r.createElement)(I,{label:"Writing Style",text:b||(D[0]?D[0].label:"Loading..."),options:D,onChange:e=>{v(e.value),w(e.label)},disabled:e||M}),(0,r.createElement)(I,{label:"Article Length",text:C,options:[{label:"Default",value:""},{label:"Short (~500 words)",value:"500"},{label:"Standard (~800 words)",value:"800"},{label:"Medium (~1200 words)",value:"1200"},{label:"Long (~2000 words)",value:"2000"}],onChange:e=>{S(e.value),x(e.label)},disabled:e||M})),(0,r.createElement)(l.TextareaControl,{label:"Custom Prompt (Optional)",value:N,onChange:T,placeholder:"Leave empty to use the selected Writing Style. If you write a prompt here, it will be used instead.",rows:"6",disabled:e||M}),(0,r.createElement)(l.CheckboxControl,{label:"Also generate a featured image",checked:A,onChange:e=>{P(e),e&&L('Create a highly photorealistic image that visually represents the following article title in the most accurate and engaging way:\n\n"{{article_title}}"\n\nGuidelines:\n- Style: photorealistic, ultra-realistic, natural lighting\n- Composition: clear, well-framed subject that directly illustrates the article title\n- Avoid: text, logos, watermarks, artistic/cartoon styles\n- Aspect ratio: 16:9 (suitable for a featured article image)\n- Quality: high-resolution, detailed textures, realistic colors'.replace("{{article_title}}",p||i))},disabled:e||M}),A&&(0,r.createElement)(l.TextareaControl,{label:"Featured Image Prompt",help:"This prompt will be used to generate the image. You can edit it as needed.",value:j,onChange:L,rows:8,disabled:e||M}),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{t(!0);const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");if(!p&&!i)return alert("Please provide a keyword or an article title."),void t(!1);try{let a=p;if(!a&&i){o("Generating compelling title...");const e=await m("generate_article_title",{keyword:i,model:E});if(!e.success)throw new Error(e.data);a=e.data.article_title}o("Writing article content...");const r=await m("generate_article_content",{post_id:e,article_title:a,model:E,writing_style:g,custom_prompt:N,word_count:k});if(!r.success)throw new Error(r.data);if(((e,t)=>{const a=document.body.classList.contains("block-editor-page"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(a,r.data.article_content),o("✅ Article content inserted!"),r.data.subtitle&&(o("✅ Article content inserted! Setting subtitle..."),setTimeout(()=>{const e=document.querySelector('input[name="_bunyad_sub_title"]');e&&(e.value=r.data.subtitle,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),console.log("ATM: Set subtitle in SmartMag input field:",r.data.subtitle));const t=document.querySelector('#_bunyad_sub_title, input[id*="sub_title"], input[id*="subtitle"]');if(t&&(t.value=r.data.subtitle,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0})),console.log("ATM: Set subtitle in Post Options field")),"undefined"!=typeof wp&&wp.data&&wp.data.select)try{const e=wp.data.select("core/editor").getCurrentPost();e&&"post"===e.type&&(wp.data.dispatch("core/editor").editPost({meta:{_bunyad_sub_title:r.data.subtitle}}),console.log("ATM: Updated Block Editor meta safely"))}catch(e){console.log("ATM: Block Editor update skipped:",e.message)}},1e3),await B(),o("✅ Article and subtitle saved!")),A){o("Saving post..."),await B(),o("Generating featured image...");const t=await m("generate_featured_image",{post_id:e,prompt:j});if(t.success)return t.data.generated_prompt&&(console.log("--- AI-Generated Image Prompt (Creative Article) ---"),console.log(t.data.generated_prompt)),o("✅ All done! Reloading to show new image..."),void setTimeout(()=>window.location.reload(),2500);alert("Article was generated and saved, but the image failed: "+t.data)}t(!1),setTimeout(()=>o(""),3e3)}catch(e){const a=e.message||"An unknown error occurred.";o(`Error: ${a}`),t(!1)}},disabled:e||M||!i&&!p},e||M?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating..."):"Generate Creative Article"),a&&(0,r.createElement)("p",{className:"atm-status-message"},a))},p=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),h=function(){const[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(""),[i,m]=(0,n.useState)(""),[u,h]=(0,n.useState)("newsapi"),[g,v]=(0,n.useState)("NewsAPI.org"),[b,w]=(0,n.useState)(!1),[E,f]=(0,n.useState)(!1),[y,_]=(0,n.useState)(""),{savePost:k}=(0,c.useDispatch)("core/editor"),S=(0,c.useSelect)(e=>e("core/editor").isSavingPost());return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(l.TextControl,{label:"News Topic",value:i,onChange:m,placeholder:"e.g., recent AI developments",disabled:e||S}),(0,r.createElement)(({label:e,text:t,options:a,onChange:o,disabled:i,helpText:c})=>{const d=(0,n.useRef)(null);return(0,r.createElement)("div",{className:"atm-dropdown-field",ref:d},(0,r.createElement)("label",{className:"atm-dropdown-label"},e),(0,r.createElement)(l.DropdownMenu,{className:"atm-custom-dropdown",icon:s,text:t,controls:a.map(e=>({title:e.label,onClick:()=>{o(e)}})),disabled:i,popoverProps:{className:"atm-popover",style:{"--atm-dropdown-width":d.current?.offsetWidth?d.current.offsetWidth+"px":"auto"}}}),c&&(0,r.createElement)("p",{className:"atm-dropdown-help"},c))},{label:"News Source",text:g,options:[{label:"NewsAPI.org",value:"newsapi"},{label:"GNews.io",value:"gnews"},{label:"The Guardian",value:"guardian"}],onChange:e=>{h(e.value),v(e.label)},disabled:e||S}),(0,r.createElement)(l.CheckboxControl,{label:"Force fresh search (bypasses cache)",checked:b,onChange:w,disabled:e||S}),(0,r.createElement)(l.CheckboxControl,{label:"Also generate a featured image",checked:E,onChange:e=>{if(f(e),e){const e=title||keyword;_('Create a highly photorealistic image that visually represents the following article title in the most accurate and engaging way:\n\n"{{article_title}}"\n\nGuidelines:\n- Style: photorealistic, ultra-realistic, natural lighting\n- Composition: clear, well-framed subject that directly illustrates the article title\n- Avoid: text, logos, watermarks, artistic/cartoon styles\n- Aspect ratio: 16:9 (suitable for a featured article image)\n- Quality: high-resolution, detailed textures, realistic colors'.replace("{{article_title}}",e))}},disabled:e||S}),E&&(0,r.createElement)(TextareaControl,{label:"Featured Image Prompt",help:"This prompt will be used to generate the image. You can edit it as needed.",value:y,onChange:_,rows:8,disabled:e||S}),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{if(!i)return void alert("Please enter a topic for the news article.");t(!0),o("Searching for latest news...");const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const a=await p("generate_news_article",{topic:i,news_source:u,force_fresh:b});if(!a.success)throw new Error(a.data);if(o("Writing article..."),((e,t)=>{const a=document.body.classList.contains("block-editor-page"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(a.data.article_title,a.data.article_content),o("✅ News article inserted!"),a.data.subtitle&&(o("✅ News article inserted! Saving post to apply subtitle..."),await k(),o("✅ News article and subtitle saved!")),E){o("Saving post..."),await k(),o("Generating featured image...");const t=await p("generate_featured_image",{post_id:e,prompt:y});if(t.success)return o("✅ All done! Reloading to show image..."),void setTimeout(()=>window.location.reload(),1500);alert("Article was generated and saved, but the image failed: "+t.data)}t(!1),setTimeout(()=>o(""),3e3)}catch(e){o(`Error: ${e.message}`),t(!1)}},disabled:e||S||!keyword&&!title},e||S?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating..."):"Generate Creative Article"),a&&(0,r.createElement)("p",{className:"atm-status-message"},a))},g=(0,i.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(o.Path,{d:"M19.5 4.5h-7V6h4.44l-5.97 5.97 1.06 1.06L18 7.06v4.44h1.5v-7Zm-13 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-3H17v3a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h3V5.5h-3Z"})}),v=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),b=function(){const[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(""),[i,s]=(0,n.useState)(""),[m,u]=(0,n.useState)(!1),[p,h]=(0,n.useState)(!0),[b,w]=(0,n.useState)([]),{savePost:E}=(0,c.useDispatch)("core/editor"),f=((0,c.useSelect)(e=>e("core/editor").isSavingPost()),async(e="",a=!1)=>{t(!0),o(e?"Searching feeds...":"Fetching latest..."),w([]);const r=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const t=await v("fetch_rss_articles",{post_id:r,keyword:e,use_scraping:a});if(!t.success)throw new Error(t.data);w(t.data),o(t.data.length>0?`Found ${t.data.length} articles.`:"No articles found.")}catch(e){o(`Error: ${e.message}`)}finally{t(!1)}});return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(l.TextControl,{label:"Search by Keyword (Optional)",value:i,onChange:s,placeholder:"e.g., Trump, AI, Healthcare",disabled:e}),(0,r.createElement)(l.CheckboxControl,{label:"Deep Content Search",help:"Scrapes full article content for more accurate keyword matching (slower but more precise).",checked:m,onChange:u,disabled:e}),(0,r.createElement)(l.CheckboxControl,{label:"Use Full Article Content for Generation",help:"Scrapes the complete article for better AI rewriting (recommended).",checked:p,onChange:h,disabled:e}),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(l.Button,{isSecondary:!0,onClick:()=>f(i,m),disabled:e||!i},e?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Searching..."):"Search Feeds"),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:()=>f(),disabled:e},e?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Fetching..."):"Fetch Latest Articles")),a&&(0,r.createElement)("p",{className:"atm-status-message"},a),b.length>0&&(0,r.createElement)("div",{className:"atm-video-results-list"}," ",b.map((a,n)=>(0,r.createElement)("div",{key:a.guid,className:"atm-video-result-item"}," ",(0,r.createElement)("div",{className:"atm-video-thumbnail"},a.image?(0,r.createElement)("img",{src:a.image,alt:a.title}):(0,r.createElement)("div",{className:"atm-rss-thumbnail-placeholder"},(0,r.createElement)("span",{className:"dashicons dashicons-rss"}))),(0,r.createElement)("div",{className:"atm-video-details"},(0,r.createElement)("h4",{className:"atm-video-title"},a.title),(0,r.createElement)("div",{className:"atm-video-meta"},(0,r.createElement)("span",null,a.source)," • ",(0,r.createElement)("span",null,a.date)),(0,r.createElement)("p",{className:"atm-video-description"},a.description.substring(0,150),"..."),(0,r.createElement)("div",{className:"atm-video-actions"},(0,r.createElement)(l.Button,{isSecondary:!0,icon:g,href:a.link,target:"_blank"},"Visit Website"),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:()=>(async(e,a)=>{o(`Generating from "${e.title}"...`),t(!0);const r=[...b];r[a].isGenerating=!0,w(r);const n=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const t=await v("generate_article_from_rss",{post_id:n,article_url:e.link,article_guid:e.guid,rss_content:e.content,use_full_content:p});if(!t.success)throw new Error(t.data);((e,t)=>{const a=document.body.classList.contains("block-editor-page"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(t.data.article_title,t.data.article_content),o(`✅ Article generated from "${e.title}"!`),w(b.filter((e,t)=>t!==a)),t.data.subtitle&&(o("✅ Article generated! Saving post to apply subtitle..."),await E(),o(`✅ Article and subtitle saved from "${e.title}"!`))}catch(e){o(`Error: ${e.message}`)}finally{t(!1);const e=[...b];e[a].isGenerating=!1,w(e)}})(a,n),disabled:e||a.isGenerating,className:"is-embed"},a.isGenerating?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating..."):"Generate Article")))))))},w=function({setActiveView:e}){const[t,a]=(0,n.useState)("creative"),[o,i]=(0,n.useState)("Creative Article");return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub")},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Generate Article")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(({label:e,text:t,options:a,onChange:o,disabled:i,helpText:c})=>{const d=(0,n.useRef)(null);return(0,r.createElement)("div",{className:"atm-dropdown-field",ref:d},(0,r.createElement)("label",{className:"atm-dropdown-label"},e),(0,r.createElement)(l.DropdownMenu,{className:"atm-custom-dropdown",icon:s,text:t,controls:a.map(e=>({title:e.label,onClick:()=>{o(e)}})),disabled:i,popoverProps:{className:"atm-popover",style:{"--atm-dropdown-width":d.current?.offsetWidth?d.current.offsetWidth+"px":"auto"}}}),c&&(0,r.createElement)("p",{className:"atm-dropdown-help"},c))},{label:"Article Type",text:o,options:[{label:"Creative Article",value:"creative"},{label:"Latest News Article",value:"news"},{label:"Article from RSS Feed",value:"rss_feed"}],onChange:e=>{a(e.value),i(e.label)}}),(0,r.createElement)("hr",{className:"atm-form-divider"}),(()=>{switch(t){case"news":return(0,r.createElement)(h,null);case"rss_feed":return(0,r.createElement)(b,null);default:return(0,r.createElement)(u,null)}})()))},E=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[o,i]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[g,v]=(0,n.useState)("Use Default"),[b,w]=(0,n.useState)(""),[E,f]=(0,n.useState)("Use Default"),[y,_]=(0,n.useState)(""),[k,S]=(0,n.useState)(""),{editPost:C}=((0,n.useRef)(null),(0,n.useRef)(null),(0,n.useRef)(null),(0,c.useDispatch)("core/editor")),{image_provider:x}=atm_studio_data,N=y||x,T=({label:e,text:t,options:a,onChange:o,disabled:i,helpText:c})=>{const d=(0,n.useRef)(null);return(0,r.createElement)("div",{className:"atm-dropdown-field",ref:d},(0,r.createElement)("label",{className:"atm-dropdown-label"},e),(0,r.createElement)(l.DropdownMenu,{className:"atm-custom-dropdown",icon:s,text:t,controls:a.map(e=>({title:e.label,onClick:()=>{o(e)}})),disabled:i,popoverProps:{className:"atm-popover",style:{"--atm-dropdown-width":d.current?.offsetWidth?d.current.offsetWidth+"px":"auto"}}}),c&&(0,r.createElement)("p",{className:"atm-dropdown-help"},c))},A=[{label:`Use Default (${x})`,value:""},{label:"OpenAI (DALL-E 3)",value:"openai"},{label:"Google (Imagen 4)",value:"google"},{label:"BlockFlow (FLUX)",value:"blockflow"}];return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:t},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Generate Featured Image")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(T,{label:"Image Provider",text:k||`Use Default (${x})`,options:A,onChange:e=>{_(e.value),S(e.label)},disabled:t}),(0,r.createElement)(l.TextareaControl,{label:"Image Prompt",help:"A descriptive prompt is required for image generation.",value:m,onChange:u,placeholder:"A cinematic, photorealistic image of...",rows:"5",disabled:t}),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(T,{label:"Image Size (Override)",text:g,options:[{label:"Use Default",value:""},{label:"16:9 Landscape",value:"1792x1024"},{label:"1:1 Square",value:"1024x1024"},{label:"9:16 Portrait",value:"1024x1792"}],onChange:e=>{h(e.value),v(e.label)},disabled:t}),(0,r.createElement)(T,{label:"Quality (Override)",text:E,options:[{label:"Use Default",value:""},{label:"Standard",value:"standard"},{label:"HD",value:"hd"}],onChange:e=>{w(e.value),f(e.label)},disabled:t,helpText:"openai"!==N?"Note: Quality setting is only for OpenAI/DALL-E 3.":""})),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{if(!m.trim())return void alert("Please enter a prompt for the image.");a(!0),i("");const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const a=await(t={post_id:e,prompt:m,size:p,quality:b,provider:N},jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:"generate_featured_image",nonce:atm_studio_data.nonce,...t}}));if(!a.success)throw new Error(a.data);{i("âœ… Image generated and set!");const{attachment_id:e,html:t}=a.data;document.body.classList.contains("block-editor-page")?C({featured_media:e}):jQuery("#postimagediv .inside").html(t)}}catch(e){const t=e.message||"An unknown error occurred.";i(`Error: ${t}`)}finally{a(!1),setTimeout(()=>i(""),5e3)}var t},disabled:t},t?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null),"Processing..."):"Generate & Set Featured Image"),o&&(0,r.createElement)("p",{className:"atm-status-message"},o)))},f=function({label:e,text:t,options:a,onChange:o,disabled:i,helpText:c}){const d=(0,n.useRef)(null);return(0,r.createElement)("div",{className:"atm-dropdown-field",ref:d},(0,r.createElement)("label",{className:"atm-dropdown-label"},e),(0,r.createElement)(l.DropdownMenu,{className:"atm-custom-dropdown",icon:s,text:t,controls:a.map(e=>({title:e.label,onClick:()=>o(e)})),disabled:i,popoverProps:{className:"atm-popover",style:{"--atm-dropdown-width":d.current?.offsetWidth?`${d.current.offsetWidth}px`:"auto"}}}),c&&(0,r.createElement)("p",{className:"atm-dropdown-help"},c))};function y({podcastUrl:e,onRegenerate:t,postId:a}){const[o,i]=(0,n.useState)(!1),{editPost:s}=(0,c.useDispatch)("core/editor"),{podcastScript:m,podcastVoice:u,podcastProvider:p}=(0,c.useSelect)(e=>({podcastScript:e("core/editor").getEditedPostAttribute("meta")?._atm_podcast_script,podcastVoice:e("core/editor").getEditedPostAttribute("meta")?._atm_podcast_voice,podcastProvider:e("core/editor").getEditedPostAttribute("meta")?._atm_podcast_provider}),[]);return(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)("h4",null,"Your Podcast is Ready"),(0,r.createElement)("p",{className:"components-base-control__help"},"A player has been automatically embedded at the top of your post."),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(l.Button,{isSecondary:!0,onClick:()=>{const e=wp.media({title:"Select Podcast Cover Image",button:{text:"Use This Image"},multiple:!1,library:{type:"image"}});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:"upload_podcast_image",nonce:atm_studio_data.nonce,post_id:a,image_id:t.id}}).done(()=>{s({meta:{_atm_podcast_image_id:t.id}}),window.location.reload()})}),e.open()}},"Change Cover Image"),(0,r.createElement)(l.Button,{isDestructive:!0,onClick:async()=>{i(!0),await t(m,u,p),i(!1)},disabled:o},o?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Regenerating..."):"Regenerate Audio")))}function _({handleGenerateScript:e,handleGenerateAudio:t,statusMessage:a,isLoading:o}){const[i,s]=(0,n.useState)(""),[c,m]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[h,g]=(0,n.useState)("English"),[v,b]=(0,n.useState)("English"),[w,E]=(0,n.useState)(atm_studio_data.audio_provider||"openai"),[y,_]=(0,n.useState)("elevenlabs"===atm_studio_data.audio_provider?"ElevenLabs":"OpenAI TTS"),k=Object.entries(atm_studio_data.tts_voices).map(([e,t])=>({label:t,value:e})),S=Object.entries(atm_studio_data.elevenlabs_voices).map(([e,t])=>({label:t,value:e})),C="elevenlabs"===w?S:k;return(0,n.useEffect)(()=>{C.length>0&&(C.find(e=>e.value===c)||(m(C[0].value),p(C[0].label)))},[w,C]),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(f,{label:"Script Language",text:v,options:[{label:"English",value:"English"},{label:"Spanish",value:"Spanish"},{label:"French",value:"French"},{label:"German",value:"German"},{label:"Chinese (Simplified)",value:"Chinese"},{label:"Japanese",value:"Japanese"},{label:"Russian",value:"Russian"},{label:"Portuguese",value:"Portuguese"},{label:"Italian",value:"Italian"},{label:"Arabic",value:"Arabic"},{label:"Hindi",value:"Hindi"},{label:"Korean",value:"Korean"},{label:"Dutch",value:"Dutch"},{label:"Turkish",value:"Turkish"},{label:"Polish",value:"Polish"}],onChange:e=>{g(e.value),b(e.label)},disabled:o}),(0,r.createElement)(l.Button,{isSecondary:!0,onClick:()=>e(h,s),disabled:o},o&&a.includes("script")?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating Script..."):"Step 1: Generate Script from Post Content"),(0,r.createElement)(l.TextareaControl,{label:"Podcast Script",help:"The generated script will appear here. You can edit it before generating the audio.",value:i,onChange:s,rows:"15",disabled:o}),(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(f,{label:"Audio Provider",text:y,options:[{label:"OpenAI TTS",value:"openai"},{label:"ElevenLabs",value:"elevenlabs"}],onChange:e=>{E(e.value),_(e.label)},disabled:o||0===S.length,helpText:0===S.length?"Enter ElevenLabs API key in settings to enable.":""}),(0,r.createElement)(f,{label:"AI Voice",text:u||(C.length>0?C[0].label:"No voices available"),options:C,onChange:e=>{m(e.value),p(e.label)},disabled:o||!C.length})),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:()=>t(i,c,w),disabled:o||!i.trim()||!c},o&&a.includes("audio")?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating Audio..."):"Step 2: Generate MP3 Audio"))}const k=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[l,o]=(0,n.useState)(""),{postId:i,existingPodcastUrl:s}=(0,c.useSelect)(e=>({postId:e("core/editor").getCurrentPostId(),existingPodcastUrl:e("core/editor").getEditedPostAttribute("meta")?._atm_podcast_url}),[]),d=async(e,t,r)=>{if(e.trim()){a(!0),o("Generating MP3 audio... this may take a minute.");try{const a=await jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:"generate_podcast",nonce:atm_studio_data.nonce,post_id:i,script:e,voice:t,provider:r}});if(!a.success)throw new Error(a.data);o("✅ Success! The page will now reload to show the audio player."),setTimeout(()=>window.location.reload(),2e3)}catch(e){o(`Error generating audio: ${e.message}`),a(!1)}}else alert("Script cannot be empty.")};return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:t},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Generate Podcast")),s?(0,r.createElement)(y,{podcastUrl:s,onRegenerate:d,postId:i}):(0,r.createElement)(_,{handleGenerateScript:async(e,t)=>{const r=wp.data.select("core/editor").getEditedPostContent();if(r.trim()){a(!0),o("Generating podcast script...");try{const a=await jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:"generate_podcast_script",nonce:atm_studio_data.nonce,content:r,post_id:i,language:e}});if(!a.success)throw new Error(a.data);t(a.data.script),o("✅ Script generated successfully. You can now edit it below.")}catch(e){o(`Error generating script: ${e.message}`)}finally{a(!1)}}else alert("Please write some content in the editor before generating a script.")},handleGenerateAudio:d,statusMessage:l,isLoading:t}),l&&(0,r.createElement)("p",{className:"atm-status-message"},l))},S=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[o,i]=(0,n.useState)(!1),[s,d]=(0,n.useState)("Click the button to start recording."),m=(0,n.useRef)(null),u=(0,n.useRef)([]),{insertBlocks:p}=(0,c.useDispatch)("core/block-editor"),h=o;return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:h||t},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Speech to Text")),(0,r.createElement)("div",{className:"atm-speech-container"},(0,r.createElement)("div",{className:"atm-recording-section"},(0,r.createElement)("div",{className:"atm-record-button-wrapper "+(t?"is-recording":"")},(0,r.createElement)("div",{className:"atm-pulse-ring atm-pulse-ring-1"}),(0,r.createElement)("div",{className:"atm-pulse-ring atm-pulse-ring-2"}),(0,r.createElement)("div",{className:"atm-pulse-ring atm-pulse-ring-3"}),(0,r.createElement)("button",{className:`atm-record-button ${t?"is-recording":""} ${o?"is-transcribing":""}`,onClick:t?()=>{m.current&&"recording"===m.current.state&&(m.current.stop(),m.current.stream.getTracks().forEach(e=>e.stop()))}:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0});m.current=new MediaRecorder(e),u.current=[],m.current.ondataavailable=e=>{e.data.size>0&&u.current.push(e.data)},m.current.onstop=()=>{a(!1),d("Recording stopped. Preparing for transcription..."),(async()=>{if(0===u.current.length)return void d("No audio recorded. Click to start again.");i(!0),d("Transcribing audio... Please wait.");const e=new Blob(u.current,{type:"audio/webm"}),t=new FormData;t.append("action","transcribe_audio"),t.append("nonce",atm_studio_data.nonce),t.append("audio_file",e,"recording.webm");try{const e=await fetch(atm_studio_data.ajax_url,{method:"POST",body:t}),a=await e.json();if(!a.success)throw new Error(a.data||"Transcription failed on the server.");{const e=a.data.transcript;if(e.trim()){const t=wp.blocks.createBlock("core/paragraph",{content:e.trim()});p(t),d("✅ Transcription complete and inserted!")}else d("Transcription returned empty. Please try again.")}}catch(e){console.error("Transcription error:",e),d(`Error: ${e.message}`)}finally{i(!1),u.current=[],setTimeout(()=>d("Click the button to start a new recording."),5e3)}})()},m.current.start(),a(!0),d("Recording... Click to stop.")}catch(e){d("Error: Could not access microphone. Please grant permission."),console.error("Microphone access error:",e)}},disabled:o},o?(0,r.createElement)(l.Spinner,null):t?(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},(0,r.createElement)("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2"})):(0,r.createElement)("img",{src:`${atm_studio_data.plugin_url}/includes/images/mic.svg`,alt:"Microphone",className:"atm-mic-icon"}))),(0,r.createElement)("p",{className:"atm-recording-status"},s)),(0,r.createElement)("div",{className:"atm-instructions"},(0,r.createElement)("p",null,"Click the microphone to start recording your voice. The audio will be automatically transcribed and inserted into your post content."))))},C=window.wp.blocks;function x({onTranscriptionComplete:e,onTranscriptionError:t}){const[a,r]=(0,n.useState)(!1),[l,o]=(0,n.useState)(!1),i=(0,n.useRef)(null),s=(0,n.useRef)([]);return{isRecording:a,isTranscribing:l,startRecording:async()=>{try{const a=await navigator.mediaDevices.getUserMedia({audio:!0});i.current=new MediaRecorder(a),s.current=[],i.current.ondataavailable=e=>{e.data.size>0&&s.current.push(e.data)},i.current.onstop=()=>{r(!1),(async()=>{if(0===s.current.length)return void t?.("No audio was recorded.");o(!0);const a=new Blob(s.current,{type:"audio/webm"}),r=new FormData;r.append("audio_file",a,"recording.webm");try{const t=await((e,t)=>(t.append("action","transcribe_audio"),t.append("nonce",atm_studio_data.nonce),fetch(atm_studio_data.ajax_url,{method:"POST",body:t}).then(e=>e.json())))(0,r);if(!t.success)throw new Error(t.data||"Transcription failed on the server.");e?.(t.data.transcript)}catch(e){t?.(e.message)}finally{o(!1),s.current=[]}})()},i.current.start(),r(!0)}catch(e){t?.("Could not access microphone. Please grant permission.")}},stopRecording:()=>{i.current&&"recording"===i.current.state&&(i.current.stop(),i.current.stream.getTracks().forEach(e=>e.stop()))}}}const N=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),T=function({setActiveView:e}){const[t,a]=(0,n.useState)(""),[o,i]=(0,n.useState)(""),[s,m]=(0,n.useState)("Spanish"),[u,p]=(0,n.useState)("Spanish"),[h,g]=(0,n.useState)(!1),[v,b]=(0,n.useState)(""),[w,E]=(0,n.useState)(""),[y,_]=(0,n.useState)("Spanish"),[k,S]=(0,n.useState)("Spanish"),[T,A]=(0,n.useState)(!1),{insertBlocks:P}=(0,c.useDispatch)("core/block-editor"),{savePost:j}=(0,c.useDispatch)("core/editor"),{isRecording:L,isTranscribing:B,startRecording:M,stopRecording:I}=x({onTranscriptionComplete:e=>{a(t=>t+(t?" ":"")+e),E("✅ Transcription complete."),setTimeout(()=>E(""),3e3)},onTranscriptionError:e=>{E(`Error: ${e}`)}}),G=[{label:"Spanish",value:"Spanish"},{label:"French",value:"French"},{label:"German",value:"German"},{label:"Chinese (Simplified)",value:"Chinese (Simplified)"},{label:"Japanese",value:"Japanese"},{label:"Russian",value:"Russian"},{label:"Portuguese",value:"Portuguese"},{label:"Italian",value:"Italian"},{label:"Arabic",value:"Arabic"},{label:"Hindi",value:"Hindi"},{label:"Korean",value:"Korean"},{label:"Dutch",value:"Dutch"},{label:"Turkish",value:"Turkish"},{label:"Polish",value:"Polish"},{label:"Swedish",value:"Swedish"}];(0,n.useEffect)(()=>{L?E("Recording..."):B&&E("Transcribing...")},[L,B]);const D=h||L||B||T;return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:D},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"AI Translator")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)("div",{className:"atm-translator-full-editor"},(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{A(!0),b("Reading editor content...");const{title:e,content:t}=(()=>{const e=wp.data.select("core/editor");return{title:e.getEditedPostAttribute("title"),content:e.getEditedPostContent()}})();if(!t.trim())return alert("Editor content is empty. Please write something to translate."),void A(!1);b(`Translating entire post to ${y}...`);try{const a=await N("translate_editor_content",{title:e,content:t,target_language:y});if(!a.success)throw new Error(a.data);{const{translated_title:e,translated_content:t}=a.data;((e,t)=>{const a=!!wp.data.select("core/block-editor"),r=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(r);wp.data.dispatch("core/block-editor").resetBlocks(t)}else jQuery("#title").val(e).trigger("blur"),window.tinymce?.get("content")?window.tinymce.get("content").setContent(r):jQuery("#content").val(r)})(e,t),b("✅ Post translated! Saving..."),await j(),b("✅ Post translated and saved!")}}catch(e){b(`Error: ${e.message}`)}finally{A(!1)}},disabled:D},T?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Translating..."):"Translate Editor"),(0,r.createElement)("span",null,"to"),(0,r.createElement)(f,{label:"",text:k,options:G,onChange:e=>{_(e.value),S(e.label)},disabled:D})),(0,r.createElement)("hr",{className:"atm-form-divider"}),(0,r.createElement)("label",{className:"components-base-control__label"},"Text Snippet to Translate"),(0,r.createElement)("div",{className:"atm-translator-main-area"},(0,r.createElement)(l.TextareaControl,{value:t,onChange:a,placeholder:"Type your text here...",rows:8,disabled:D,className:"atm-translator-text-input"}),(0,r.createElement)("div",{className:"atm-translator-recorder"},(0,r.createElement)("h4",null,"Or Record to Translate"),(0,r.createElement)("div",{className:"atm-record-button-wrapper is-small "+(L?"is-recording":"")},(0,r.createElement)("div",{className:"atm-pulse-ring atm-pulse-ring-1"}),(0,r.createElement)("div",{className:"atm-pulse-ring atm-pulse-ring-2"}),(0,r.createElement)("button",{className:`atm-record-button ${L?"is-recording":""} ${B?"is-transcribing":""}`,onClick:L?I:M,disabled:D,"aria-label":L?"Stop Recording":"Start Recording"},B?(0,r.createElement)(d,null):L?(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor"},(0,r.createElement)("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2"})):(0,r.createElement)("img",{src:`${atm_studio_data.plugin_url}/includes/images/mic.svg`,alt:"Microphone",className:"atm-mic-icon"}))),(L||B||w)&&(0,r.createElement)("p",{className:"atm-recording-status"},w))),(0,r.createElement)(f,{label:"Translate Snippet To",text:u,options:G,onChange:e=>{m(e.value),p(e.label)},disabled:D}),(0,r.createElement)(l.Button,{isSecondary:!0,onClick:async()=>{if(!t.trim())return alert("Please enter text to translate.");g(!0),b(`Translating to ${s}...`),i("");try{const e=await N("translate_text",{source_text:t,target_language:s});if(!e.success)throw new Error(e.data);i(e.data.translated_text),b("✅ Translation successful!")}catch(e){b(`Error: ${e.message}`)}finally{g(!1)}},disabled:D||!t.trim()},h?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Translating..."):"Translate Snippet"),(0,r.createElement)(l.TextareaControl,{label:"Translated Snippet",value:o,readOnly:!0,rows:8}),(0,r.createElement)(l.Button,{isSecondary:!0,onClick:()=>{o.trim()&&(P((0,C.createBlock)("core/paragraph",{content:o.trim()})),b("Text inserted into editor!"))},disabled:!o.trim()||D},"Insert Snippet into Editor"),v&&(0,r.createElement)("p",{className:"atm-status-message"},v)))},A=(0,n.forwardRef)(({icon:e,size:t=24,...a},r)=>(0,n.cloneElement)(e,{width:t,height:t,...a,ref:r})),P=(0,i.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(o.Path,{d:"M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"})}),j=function({onSearch:e,onFilterClick:t,disabled:a}){const[o,i]=(0,n.useState)("");return(0,r.createElement)("div",{className:"atm-autocomplete-container"},(0,r.createElement)("form",{className:"atm-autocomplete-form",onSubmit:t=>{t.preventDefault(),e(o)}},(0,r.createElement)(l.TextControl,{value:o,onChange:e=>i(e),placeholder:"Search for videos on YouTube...",disabled:a}),(0,r.createElement)(l.Button,{type:"submit",isPrimary:!0,disabled:a||!o,className:"atm-search-button"},(0,r.createElement)(A,{icon:P})),(0,r.createElement)(l.Button,{isSecondary:!0,onClick:t,disabled:a,className:"atm-filter-button"},(0,r.createElement)("img",{src:`${atm_studio_data.plugin_url}includes/images/filter.svg`,alt:"Filter",className:"atm-button-icon"}))))},L=(0,i.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(o.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})}),B=(0,i.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(o.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),M=function({video:e,onEmbed:t}){const[a,o]=(0,n.useState)(!1);return(0,r.createElement)("div",{className:"atm-video-result-item"},(0,r.createElement)("div",{className:"atm-video-thumbnail"},(0,r.createElement)("img",{src:e.thumbnail,alt:e.title})),(0,r.createElement)("div",{className:"atm-video-details"},(0,r.createElement)("h4",{className:"atm-video-title"},e.title),(0,r.createElement)("p",{className:"atm-video-description"},e.description),(0,r.createElement)("div",{className:"atm-video-meta"},(0,r.createElement)("span",null,e.channel)," • ",(0,r.createElement)("span",null,e.date)),(0,r.createElement)("div",{className:"atm-video-actions"},(0,r.createElement)(l.Button,{icon:g,href:e.url,target:"_blank"},"Watch"),(0,r.createElement)(l.Button,{icon:L,onClick:()=>{navigator.clipboard.writeText(e.url),o(!0),setTimeout(()=>o(!1),2e3)}},a?"Copied!":"Copy Link"),(0,r.createElement)(l.Button,{icon:B,onClick:()=>t(e.url),className:"is-embed"},"Embed"))))},I=function({isOpen:e,onClose:t,filters:a,onFilterChange:n}){return e?(0,r.createElement)(l.Modal,{title:"Search Filters",onRequestClose:t,className:"atm-filter-modal"},(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(l.SelectControl,{label:"Sort By",value:a.order,options:[{label:"Relevance",value:"relevance"},{label:"Upload Date",value:"date"},{label:"View Count",value:"viewCount"},{label:"Rating",value:"rating"}],onChange:e=>n("order",e),disabled:!!a.publishedAfter}),(0,r.createElement)(l.SelectControl,{label:"Duration",value:a.videoDuration,options:[{label:"Any",value:"any"},{label:"Short (< 4 min)",value:"short"},{label:"Medium (4-20 min)",value:"medium"},{label:"Long (> 20 min)",value:"long"}],onChange:e=>n("videoDuration",e)}),(0,r.createElement)(l.SelectControl,{label:"Upload Date",value:a.publishedAfter,options:[{label:"Anytime",value:""},{label:"Last Hour",value:"hour"},{label:"Today",value:"day"},{label:"This Week",value:"week"},{label:"This Month",value:"month"},{label:"This Year",value:"year"}],onChange:e=>n("publishedAfter",e)}))):null},G=function({setActiveView:e}){const[t,a]=(0,n.useState)([]),[o,i]=(0,n.useState)(!1),[s,d]=(0,n.useState)("Enter a search term to find YouTube videos."),[m,u]=(0,n.useState)(""),[p,h]=(0,n.useState)(!1),[g,v]=(0,n.useState)({order:"relevance",videoDuration:"any",publishedAfter:""}),{insertBlocks:b}=(0,c.useDispatch)("core/block-editor"),w=async e=>{if(e){u(e),i(!0),a([]),d(`Searching for "${e}"...`);try{const r=await(t={query:e,filters:g},jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:"search_youtube",nonce:atm_studio_data.nonce,...t}}));if(!r.success)throw new Error(r.data);a(r.data),d(r.data.length>0?`Showing results for "${e}"`:"No results found.")}catch(e){d(`Error: ${e.message}`)}finally{i(!1)}var t}};(0,n.useEffect)(()=>{m&&w(m)},[g]);const E=e=>{if(wp.data.select("core/block-editor")){const t=(0,C.createBlock)("core/embed",{url:e,providerNameSlug:"youtube",align:"wide",className:"atm-youtube-embed"});b(t)}else{const t=`\n<div class="wp-video" style="width: 100%;"><iframe src="${e.replace("/watch?v=","/embed/")}" width="500" height="281" style="width: 100%; aspect-ratio: 16/9; height: auto;" frameborder="0" allowfullscreen></iframe></div>\n`;window.send_to_editor(t)}d("✅ Video embedded successfully!")};return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:o},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"YouTube Video Search")),(0,r.createElement)("div",{className:"atm-video-search-container"},(0,r.createElement)(j,{onSearch:w,onFilterClick:()=>h(!0),disabled:o}),(0,r.createElement)("p",{className:"components-base-control__help",style:{marginTop:"-1rem"}},"Search for videos on YouTube. Use filters for more specific results."),o&&(0,r.createElement)("div",{className:"atm-video-spinner-container"},(0,r.createElement)(l.Spinner,null)),!o&&t.length>0&&(0,r.createElement)("div",{className:"atm-video-results-list"},t.map(e=>(0,r.createElement)(M,{key:e.id,video:e,onEmbed:E}))),!o&&0===t.length&&(0,r.createElement)("p",{className:"atm-status-message"},s)),(0,r.createElement)(I,{isOpen:p,onClose:()=>h(!1),filters:g,onFilterChange:(e,t)=>{v(a=>{const r={...a,[e]:t};return"publishedAfter"===e&&""!==t&&(r.order="date"),"order"===e&&"relevance"===t&&(r.publishedAfter=""),r})}}))},D=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),R=function({setActiveView:e}){const[t,a]=(0,n.useState)(""),[o,i]=(0,n.useState)(null),[s,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)("Describe the chart you want to create."),p=(0,n.useRef)(null),[h,g]=(0,n.useState)(""),[v,b]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=null,t=null;return p.current&&o&&new Promise((e,t)=>{if(window.echarts)return e(window.echarts);const a=document.createElement("script");a.src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js",a.onload=()=>e(window.echarts),a.onerror=t,document.head.appendChild(a)}).then(a=>{e=a.init(p.current,"light"),e.setOption(JSON.parse(o)),t=new ResizeObserver(()=>{e?.resize()}),t.observe(p.current)}).catch(e=>console.error("ECharts loading failed:",e)),()=>{t?.disconnect(),e?.dispose()}},[o]),(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:s},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"AI Chart Generator")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)(l.TextareaControl,{label:"Chart Description",help:"Describe the chart you want to create. Be specific about the type and data.",value:t,onChange:a,placeholder:"e.g., A bar chart showing monthly revenue for the last 6 months",rows:4,disabled:s}),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{if(t.trim()){c(!0),u("Generating chart data and configuration..."),i(null);try{const e=await D("generate_chart_from_ai",{prompt:t});if(!e.success)throw new Error(e.data);i(e.data.chart_config),u("✅ Chart generated successfully!")}catch(e){u(`Error: ${e.message}`)}finally{c(!1)}}else alert("Please enter a description for your chart.")},disabled:s||!t.trim()},s?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating..."):"Generate Chart"),m&&(0,r.createElement)("p",{className:"atm-status-message"},m),(0,r.createElement)("div",{className:"atm-chart-preview-container"},(0,r.createElement)("div",{ref:p,style:{width:"100%",height:"400px",display:o?"block":"none"}})),o&&(0,r.createElement)("div",{className:"atm-chart-actions"},(0,r.createElement)(l.TextControl,{label:"Chart Title (for your reference)",value:h,onChange:g,placeholder:"e.g., Q3 Sales Report",disabled:s}),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{if(h.trim()){c(!0),u("Saving chart...");try{const e=await D("save_atm_chart",{title:h,chart_config:o,chart_id:v});if(!e.success)throw new Error(e.data);b(e.data.chart_id),u("✅ Chart saved successfully! Use the shortcode to embed it.")}catch(e){u(`Error: ${e.message}`)}finally{c(!1)}}else alert("Please provide a title for your chart before saving.")},disabled:s||!h.trim()},s?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," ",v?"Updating...":"Saving..."," "):v?"Update Chart":"Save Chart"),v&&(0,r.createElement)("div",{className:"atm-shortcode-display"},(0,r.createElement)("p",null,"Embed this chart anywhere with this shortcode:"),(0,r.createElement)(l.TextControl,{value:`[atm_chart id="${v}"]`,readOnly:!0,onClick:e=>e.target.select()})))))},V=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),O=function({setActiveView:e}){const[t,a]=(0,n.useState)(!1),[o,i]=(0,n.useState)(!1),[s,c]=(0,n.useState)(""),[m,u]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[g,v]=(0,n.useState)("Use Default Model"),[b,w]=(0,n.useState)("dark"),[E,y]=(0,n.useState)("Dark"),_=[{label:"Use Default Model",value:""},...Object.entries(atm_studio_data.content_models).map(([e,t])=>({label:t,value:e}))];return(0,r.createElement)("div",{className:"atm-generator-view"},(0,r.createElement)("div",{className:"atm-view-header"},(0,r.createElement)("button",{className:"atm-back-btn",onClick:()=>e("hub"),disabled:t||o},(0,r.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,r.createElement)("h3",null,"Key Takeaways")),(0,r.createElement)("div",{className:"atm-form-container"},(0,r.createElement)("div",{className:"atm-grid-2"},(0,r.createElement)(f,{label:"AI Model",text:g,options:_,onChange:e=>{h(e.value),v(e.label)},disabled:t||o}),(0,r.createElement)(f,{label:"Theme",text:E,options:[{label:"Dark",value:"dark"},{label:"Light",value:"light"}],onChange:e=>{w(e.value),y(e.label)},disabled:t||o})),(0,r.createElement)(l.Button,{isPrimary:!0,onClick:async()=>{const e=wp.data.select("core/editor").getEditedPostContent();if(e.trim()){a(!0),c("Generating takeaways from post content..."),u("");try{const t=await V("generate_key_takeaways",{content:e,model:p});if(!t.success)throw new Error(t.data);u(t.data.takeaways),c("✅ Takeaways generated successfully. You can edit them below.")}catch(e){c(`Error: ${e.message||"An unknown error occurred."}`)}finally{a(!1)}}else alert("Editor content is empty. Please write something first.")},disabled:t||o},t?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Generating..."):"Generate Takeaways from Post Content"),(0,r.createElement)(l.TextareaControl,{label:"Key Takeaways",help:"One takeaway per line. Edit as needed before saving.",value:m,onChange:u,rows:8,disabled:t||o}),(0,r.createElement)(l.Button,{isSecondary:!0,onClick:async()=>{if(!m.trim())return void alert("There are no takeaways to save.");i(!0),c("Saving takeaways...");const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");try{const t=await V("save_key_takeaways",{post_id:e,takeaways:m,theme:b});if(!t.success)throw new Error(t.data);c("✅ Takeaways saved!")}catch(e){c(`Error: ${e.message||"An unknown error occurred."}`)}finally{i(!1)}},disabled:t||o||!m},o?(0,r.createElement)(r.Fragment,null,(0,r.createElement)(d,null)," Saving..."):"Save Takeaways"),s&&(0,r.createElement)("p",{className:"atm-status-message"},s)))},F=function(){const[e,t]=(0,n.useState)(sessionStorage.getItem("atm-active-view")||"articles");(0,n.useEffect)(()=>{sessionStorage.setItem("atm-active-view",e)},[e]);const a=[{section:"Content Generation",items:[{id:"articles",label:"Generate Articles",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})),description:"Create high-quality content with AI assistance"},{id:"images",label:"Generate Images",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})),description:"Generate stunning featured and inline images"},{id:"podcast",label:"Generate Podcast",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})),description:"Convert your articles into engaging audio content"},{id:"takeaways",label:"Key Takeaways",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})),description:"Extract key points from your content"}]},{section:"Tools & Utilities",items:[{id:"speech_to_text",label:"Speech to Text",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})),description:"Convert speech to text with AI transcription"},{id:"translate",label:"Translate Text",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"})),description:"Translate content to multiple languages"},{id:"video",label:"Video Search",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})),description:"Find and embed YouTube videos"},{id:"graphs",label:"Generate Charts",icon:(0,r.createElement)("svg",{width:"20",height:"20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},(0,r.createElement)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})),description:"Create dynamic charts and visualizations"}]}],l=(()=>{for(const t of a){const a=t.items.find(t=>t.id===e);if(a)return a}return{label:"AI Studio",description:"Content creation tools"}})();return(0,r.createElement)("div",{className:"atm-studio-wrapper"},(0,r.createElement)("div",{className:"atm-sidebar"},(0,r.createElement)("div",{className:"atm-sidebar-header"},(0,r.createElement)("h2",null,"AI Studio"),(0,r.createElement)("p",null,"Content Creation Suite")),a.map((a,n)=>(0,r.createElement)("div",{key:n,className:"atm-nav-section"},(0,r.createElement)("div",{className:"atm-nav-section-title"},a.section),a.items.map(a=>(0,r.createElement)("button",{key:a.id,className:"atm-nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id)},(0,r.createElement)("span",{className:"atm-nav-icon"},a.icon),a.label))))),(0,r.createElement)("div",{className:"atm-main-content"},(0,r.createElement)("div",{className:"atm-content-header"},(0,r.createElement)("h1",{className:"atm-content-title"},l.label),(0,r.createElement)("p",{className:"atm-content-subtitle"},l.description)),(0,r.createElement)("div",{className:"atm-content-body"},(()=>{switch(e){case"articles":default:return(0,r.createElement)(w,{setActiveView:t});case"images":return(0,r.createElement)(E,{setActiveView:t});case"podcast":return(0,r.createElement)(k,{setActiveView:t});case"speech_to_text":return(0,r.createElement)(S,{setActiveView:t});case"translate":return(0,r.createElement)(T,{setActiveView:t});case"video":return(0,r.createElement)(G,{setActiveView:t});case"graphs":return(0,r.createElement)(R,{setActiveView:t});case"takeaways":return(0,r.createElement)(O,{setActiveView:t})}})())))};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("atm-studio-root");e&&(0,n.render)((0,r.createElement)(F,null),e)})})();