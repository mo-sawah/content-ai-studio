(()=>{"use strict";const e=window.React,t=window.wp.element,a=window.wp.components,n=function({setActiveView:t}){return(0,e.createElement)("div",{className:"atm-hub"},(0,e.createElement)("h2",null,"How can I help you today :)"),(0,e.createElement)("p",{className:"atm-hub-subtitle"},"Generate articles, images, podcasts and many more soon"),(0,e.createElement)("div",{className:"atm-hub-actions"},(0,e.createElement)(a.Button,{isPrimary:!0,onClick:()=>t("articles")},"Generate Articles"),(0,e.createElement)(a.Button,{isPrimary:!0,onClick:()=>t("images")},"Generate Images"),(0,e.createElement)(a.Button,{isPrimary:!0,onClick:()=>t("podcast")},"Generate Podcast"),(0,e.createElement)(a.Button,{isPrimary:!0,onClick:()=>t("graphs")},"Generate Graphs"),(0,e.createElement)(a.Button,{isPrimary:!0,disabled:!0},"Generate Videos"),(0,e.createElement)(a.Button,{isSecondary:!0,disabled:!0},"Coming Soon")),(0,e.createElement)("p",{className:"atm-hub-footer"},"Your Day to Day AI helper, Content AI Studio."))},l=(e,t)=>jQuery.ajax({url:atm_studio_data.ajax_url,type:"POST",data:{action:e,nonce:atm_studio_data.nonce,...t}}),r=function({setActiveView:n}){const[r,o]=(0,t.useState)(!1),[i,s]=(0,t.useState)(""),[c,d]=(0,t.useState)("creative"),[m,u]=(0,t.useState)(""),[g,w]=(0,t.useState)(""),[p,b]=(0,t.useState)("default_seo"),[h,v]=(0,t.useState)(""),[E,y]=(0,t.useState)(""),[C,k]=(0,t.useState)(""),[S,_]=(0,t.useState)(!1),f=[{label:"Use Default Model",value:""},...Object.entries(atm_studio_data.article_models).map(([e,t])=>({label:t,value:e}))],A=Object.entries(atm_studio_data.writing_styles).map(([e,{label:t}])=>({label:t,value:e}));return(0,e.createElement)("div",{className:"atm-generator-view"},(0,e.createElement)("div",{className:"atm-view-header"},(0,e.createElement)("button",{className:"atm-back-btn",onClick:()=>n("hub"),disabled:r},(0,e.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))),(0,e.createElement)("h3",null,"Generate Article")),(0,e.createElement)("div",{className:"atm-form-container"},(0,e.createElement)(a.SelectControl,{label:"Article Type",value:c,options:[{label:"Creative Article",value:"creative"}],onChange:e=>d(e),disabled:r}),(0,e.createElement)("div",{className:"atm-grid-2"},(0,e.createElement)(a.TextControl,{label:"Keyword",value:m,onChange:e=>u(e),placeholder:"e.g., AI in digital marketing",disabled:r}),(0,e.createElement)(a.TextControl,{label:"or Article Title",value:g,onChange:e=>w(e),placeholder:"e.g., 5 Ways AI is Revolutionizing Marketing",disabled:r})),(0,e.createElement)("div",{className:"atm-grid-3"},(0,e.createElement)(a.SelectControl,{label:"Article Model",value:h,options:f,onChange:e=>v(e),disabled:r}),(0,e.createElement)(a.SelectControl,{label:"Writing Style",value:p,options:A,onChange:e=>b(e),disabled:r}),(0,e.createElement)(a.SelectControl,{label:"Article Length",value:E,options:[{label:"Default",value:""},{label:"Short (~500 words)",value:"500"},{label:"Standard (~800 words)",value:"800"},{label:"Medium (~1200 words)",value:"1200"},{label:"Long (~2000 words)",value:"2000"}],onChange:e=>y(e),disabled:r})),(0,e.createElement)(a.TextareaControl,{label:"Custom Prompt (Optional)",value:C,onChange:e=>k(e),placeholder:"Leave empty to use the selected Writing Style. If you write a prompt here, it will be used instead.",rows:"6",disabled:r}),(0,e.createElement)(a.CheckboxControl,{label:"Also generate a featured image",checked:S,onChange:_,disabled:r}),(0,e.createElement)(a.Button,{isPrimary:!0,onClick:async()=>{o(!0);const e=document.getElementById("atm-studio-root").getAttribute("data-post-id");if(!g&&!m)return alert("Please provide a keyword or an article title."),void o(!1);try{let t=g;if(!t&&m){s("Generating compelling title...");const e=await l("generate_article_title",{keyword:m,model:h});if(!e.success)throw new Error(e.data);t=e.data.article_title}s("Writing article content...");const a=await l("generate_article_content",{post_id:e,article_title:t,model:h,writing_style:p,custom_prompt:C,word_count:E});if(!a.success)throw new Error(a.data);if(((e,t)=>{const a=document.body.classList.contains("block-editor-page"),n=window.marked?window.marked.parse(t):t;if(a){wp.data.dispatch("core/editor").editPost({title:e});const t=wp.blocks.parse(n),a=wp.data.select("core/block-editor").getBlocks();if(a.length>0&&(1!==a.length||"core/paragraph"!==a[0].name||""!==a[0].attributes.content)){const e=a.map(e=>e.clientId);wp.data.dispatch("core/block-editor").removeBlocks(e)}wp.data.dispatch("core/block-editor").insertBlocks(t)}else jQuery("#title").val(e),jQuery("#title-prompt-text").hide(),jQuery("#title").trigger("blur"),window.tinymce&&window.tinymce.get("content")?window.tinymce.get("content").setContent(n):jQuery("#content").val(n)})(t,a.data.article_content),s("✅ Article content inserted!"),S){s("Generating featured image...");const t=await l("generate_featured_image",{post_id:e,prompt:""});if(t.success)return s("✅ All done! Reloading to show image..."),void setTimeout(()=>window.location.reload(),2e3);alert("Article was generated, but the image failed: "+t.data)}o(!1),setTimeout(()=>s(""),3e3)}catch(e){const t=e.message||"An unknown error occurred.";s(`Error: ${t}`),o(!1)}},disabled:r||!m&&!g},r?(0,e.createElement)(a.Spinner,null):"Generate Article"),i&&(0,e.createElement)("p",{className:"atm-status-message"},i)))},o=function(){const[a,l]=(0,t.useState)(sessionStorage.getItem("atm-active-view")||"hub");return(0,t.useEffect)(()=>{sessionStorage.setItem("atm-active-view",a)},[a]),(0,e.createElement)("div",{className:"atm-studio-container"},(()=>{switch(a){case"articles":return(0,e.createElement)(r,{setActiveView:l});case"images":return(0,e.createElement)("div",null,"Image Generator UI will go here. ",(0,e.createElement)("button",{onClick:()=>l("hub")},"← Back"));default:return(0,e.createElement)(n,{setActiveView:l})}})())};document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("atm-studio-root");a&&(0,t.render)((0,e.createElement)(o,null),a)})})();